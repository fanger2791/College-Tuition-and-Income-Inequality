---
title: "Income Disparity and Its Influence on Higher Education Affordability and Access"
author: 
  - Michael Fang
  - Harrison Huang
thanks: "Code and data are available at: LINK."
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
toc: true
number-sections: true
bibliography: references.bib
---

https://www.aeaweb.org/articles?id=10.1257/aer.20181027

# Introduction

In recent years, the escalating cost of college tuition in the United States has emerged as a critical issue, intertwining with the broader narrative of rising income inequality. The paper by  Zhifeng Cai and Jonathan Heathcote addresses this pressing concern by examining the relationship between these two phenomena. Utilizing a competitive model of the college market, the study not only uncovers the mechanisms that link rising income inequality to increasing tuition costs but also sheds light on the consequent impacts on college attendance and social mobility. Through this paper, we aim to illuminate the unique challenges and opportunities facing the Canadian higher education system in the context of rising tuition costs and income inequality. Incorporating a Canadian perspective into our reproduction study adds a crucial comparative dimension, allowing us to explore the dynamics of university tuition and income inequality within a different national context. This extension acknowledges the distinct structure of the Canadian higher education system and its funding mechanisms, which differ from those in the United States in terms of government support, the magnitude of tuition fees, and the socio-economic landscape.

Central to the Zhifeng Cai and Jonathan Heathcote paper's findings is the assertion that the surge in U.S. income inequality since the 1990s can account for more than half of the observed increase in average net tuition over the same period. This relationship underscores a critical feedback loop where income disparities not only affect individual capacity to afford higher education but also drive institutional behaviors around tuition setting. Moreover, the paper highlights the detrimental effects of rising tuition on college attendance rates, particularly among lower-income segments, positing significant implications for social mobility and equity.

To build upon the original work of  Zhifeng Cai and Jonathan Heathcote, our project will undertake a reproduction of the study, focusing on two or three of its core aspects. This will involve:

1. Recreating the Model: We will start by reproducing the competitive college market model used in the original study, ensuring our work is entirely reproducible. This step includes verifying the model's assumptions, computational methods, and data inputs.
2. Expanding the Study with an analysis on Canadian Universities: Specifically examine how income inequality within Canada affects university tuition, comparing these dynamics with the findings from the U.S. context. This will provide insights into how different policy environments and socio-economic conditions influence the relationship between income inequality and higher education costs.

Our project involves crafting a concise paper that encapsulates the entire reproduction study. This paper will meticulously outline our source and methodology, ensuring clarity on how we've mirrored the original study's model while integrating steps for high reproducibility. It will also present a comparative analysis of our findings against the original study's conclusions, pinpointing any variances and their potential causes. Additionally, the paper will delve into the implications of our policy simulations, offering insights into how income inequality influences college tuition and attendance. Lastly, it will propose directions for future research, highlighting areas within the college tuition-income inequality nexus that remain unexplored, setting the stage for subsequent scholarly inquiry.

# Data {#sec-data}

## Source



## Methodology

In replicating the original model by Zhifeng Cai and Jonathan Heathcote, our methodology was meticulously crafted to mirror their approach with precision, ensuring the highest degree of reproducibility. This entailed a thorough analysis of the original study's model, including its assumptions, variables, and computational methods. We closely followed the procedural steps outlined in their research, from data collection through to the analytical techniques employed to examine the relationship between income inequality and college tuition costs. To guarantee reproducibility, we documented each step of our process in detail, including the coding practices, statistical software used, and the sources of our data. This approach not only underscores our commitment to transparency and scientific integrity but also enhances the reliability of our replication efforts.

## Features


# Results

## College Tuition And Fees

```{r}
#| label: fig-stickers
#| fig-cap: College Tuition And Fees, US$(2016)
#| echo: false
#| warning: false

# Load necessary libraries
library(ggplot2)
library(readxl)
library(dplyr)
library(tidyr)
library(readr)

# Set the file path 
file_path <- "../data/analysis_data/college_tuition_fees_analysis_data.csv"

# Read the data from the CSV file
data <- read_csv(file_path)

# Convert data types if necessary - all price columns should be numeric
data <- mutate(data, 
               `Public Sticker` = as.numeric(`Public Sticker`),
               `Public Net` = as.numeric(`Public Net`),
               `Private Sticker` = as.numeric(`Private Sticker`),
               `Private Net` = as.numeric(`Private Net`))

# Remove rows with NA values in any of the price columns
data <- na.omit(data)

# Ensure 'Academic Year' is a factor to maintain order in the plot
data$`Academic Year` <- factor(data$`Academic Year`, levels = unique(data$`Academic Year`))

# Reshape data to long format for ggplot2
data_long <- gather(data, key = "Price Type", value = "Amount", -`Academic Year`)

# Plot using the reshaped data
p <- ggplot(data_long, aes(x=`Academic Year`, y=Amount, group=`Price Type`, colour=`Price Type`)) +
  geom_line() +
  labs(
       x='Academic Year', y='Price in $') +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  scale_colour_manual(values = c("Public Sticker"="blue", "Public Net"="green", "Private Sticker"="red", "Private Net"="purple"))

# Print the plot to see if it appears in the R console
print(p)

# Save the plot
ggsave("figure_1_plot.png", plot = p, width = 12, height = 8)
```

@fig-stickers, as presented, showcases a multi-decade overview of college tuition and fees in the United States, providing a clear visual representation of trends across both public and private institutions, accounting for inflation to 2016 dollars. The graph is particularly telling in its illustration of the divergent paths between sticker prices and net prices over time.

The private sticker prices, marked by the red line, demonstrate an unbroken ascent throughout the years, effectively doubling from the early 1990s to 2017. This relentless increase is indicative of a higher education market that is possibly responding to increased demand, or perhaps reflecting rising costs associated with providing education, such as faculty salaries, facilities, and resources.

In contrast, the private net prices, shown with the purple line, while following an upward trajectory, do so with a less pronounced slope. This implies that financial aid has absorbed some of the shock of rising sticker prices for students, although it's worth noting that the gap between sticker and net prices appears to widen over time, suggesting that financial aid may not be keeping pace with the increases in sticker prices.

For public institutions, the sticker prices, represented by blue line, show a significant increase but remain substantially lower than those of private institutions. This could reflect the impact of state funding and the different market pressures affecting public colleges and universities. The relatively gentle slope of the public net prices, depicted by the green line, indicates a measure of stability in what students actually pay, possibly due to a combination of state subsidies, federal aid, and institutional grants.

The stability of public net prices, despite the increase in public sticker prices, could be seen as a reflection of a commitment to maintaining access to higher education. However, the upward trend in both sticker and net prices, even if modest for public institutions, points to a broader trend of increasing financial burden on students and families, which may have significant implications for access to higher education, especially for those from lower-income backgrounds.

Analyzing Figure 1 also prompts consideration of the broader economic context, including changes in the funding models for higher education, the role of government policy, and the economic factors at play during this period, such as recessions and economic booms, which can influence both the supply and demand sides of higher education. The continuous rise in prices, especially in the private sector, may also reflect a competitive market where institutions vie for prestige, faculty, and facilities, which in turn, raises the question of the true value of higher education and the return on investment for students.

## Comparison of Income Distribution for 1989 and 2016

```{r}
#| label: fig-log
#| fig-cap: Comparison of Income Distribution for 1989 and 2016
#| echo: false
#| warning: false
#| message: false

library(readxl)
library(ggplot2)
library(dplyr)
library(tidyr)

# Define the path to your Excel file (Please update path to your own path where the data has been downloaded)
file_path <- "/Users/michaelfang/Downloads/SCF_AER_submit.xlsx"

# Read the "Data for Figure 9" sheet from the Excel file
data <- read_excel(file_path, sheet = "Data for Figure 9", skip = 4)

data_long <- data %>%
  pivot_longer(
    cols = c(`...1`, `...3`),
    names_to = "Year",
    values_to = "GridLogIncome"
  ) %>%
  pivot_longer(
    cols = c(`2016`, `1989`),
    names_to = "Temp",
    values_to = "EMG_ML_PDF"
  ) %>%
  filter(Year != Temp) %>%
  mutate(Year = ifelse(Year == "...1", "2016", "1989")) %>%
  select(-Temp)

# Plot the data
ggplot(data_long, aes(x = GridLogIncome, y = EMG_ML_PDF, color = Year)) +
  geom_line() +
  labs(
       x = "Log Household Income",
       y = "Density") +
  theme_minimal() +
  scale_color_manual(values = c("2016" = "blue", "1989" = "red"))
```

@fig-log is a comparison of estimated income distributions for two different years, 1989 and 2016, represented using a probability density function on a logarithmic scale for household income.

The x-axis represents the logarithm of household income, indicating that the data is not raw income but transformed using a logarithmic function, likely to normalize the distribution and to handle the wide range of incomes more effectively. The use of logarithms in income distribution is common as it tends to make the distribution more symmetric and resemble a normal distribution, which is easier to work with statistically.

The y-axis represents the density, which is the probability per unit on the x-axis. In a probability density function, the area under the curve for a given interval represents the probability that a randomly selected household will have an income within that interval.

The increase in the variance of log income suggests that income inequality has widened from 1989 to 2016. This finding correlates with the hypothesis that growing income inequality might be one of the drivers behind the increase in college tuition. This could indicate that while the relative differences in income may have not shifted dramatically on a logarithmic scale, the actual incomes have grown, particularly at the higher end, contributing to the right skewness seen in the 2016 distribution.

```{r}
#| echo: false
#| warning: false
#| message: false

library(ggplot2)
library(readxl)
library(dplyr)
library(tidyr)
library(tibble)
library(knitr)

# Set the file path
file_path <- "/Users/michaelfang/Downloads/Figure_1_data.xlsx"

## Fig 10 is public college net prices
## Fig 11 is private college net prices 
public_college_netprice <- read_excel(file_path, sheet = "Fig 10", range = cell_cols("B:V"))
private_college_netprice <- read_excel(file_path, sheet = "Fig 11", range = cell_cols("B:V"))


## Fig 2013_12 public four year total grants by income and year
## Fig 2013_13 private four year total grants by income and year

public_college_grants <- read_excel(file_path, sheet = "Fig 2013_12", range = cell_cols("B:T"))
private_college_grants <- read_excel(file_path, sheet = "Fig 2013_13", range = cell_cols("B:T"))

# modifying column names for better access
colnames(public_college_grants) <- c("1999_low", "2003_low", "2007_low", "2011_low", "empty1", "1999_sec", "2003_sec", "2007_sec", "2011_sec", "empty2", "1999_third", "2003_third", "2007_third", "2011_third", "empty3", "1999_high", "2003_high", "2007_high", "2011_high", "empty4")


# modifying column names for better access
colnames(private_college_grants) <- c("1999_low", "2003_low", "2007_low", "2011_low", "empty1", "1999_sec", "2003_sec", "2007_sec", "2011_sec", "empty2", "1999_third", "2003_third", "2007_third", "2011_third", "empty3", "1999_high", "2003_high", "2007_high", "2011_high", "empty4")

# creating the column names
expenditure_type <- c("Net TFRB", "Grants by Income(1)", "Grants by Income(2)", "Grants by Income(3)", "Grants by Income(4)", "Funding for Higher Education per 1000$ of Income", "Tuition Revanue", "Subsidy")

## Fig 14B about the total funding in billions
#funding_for_higher_education <- read_excel(file_path, sheet = "Fig 15B")

## Fig 15A average state and local funding for higher education per 1000$ of personal income
state_funding <- read_excel(file_path, sheet = "Fig 15A")
colnames(state_funding) <- c('Year','Funding Per 1000 Income') 

## Fig 17A public 4 year of subsidies and revenues in different years
public_rev_subs <- read_excel(file_path, sheet = "Fig 17A")
colnames(public_rev_subs) <- c("Institution Type","Year", "Net Tuition Revenue", "Subsidy", "Education Related Expenditures") 

## Fig 17B private 4 year of subsidies and revenues in different years
private_rev_subs <- read_excel(file_path, sheet = "Fig 17B")
colnames(private_rev_subs) <- c("Institution Type","Year", "Net Tuition Revenue", "Subsidy", "Education Related Expenditures") 

```
\newpage

## Public Four Year College Data

```{r}
#| message: false
#| echo: false
#| label: tbl-public_data
#| tbl-cap: Public Four Year College Data

# this is to shorten the name allowing cleaner code and set all items to numeric
pcn <- public_college_netprice
pcg <- public_college_grants


# rounding numbers to get rid of long decimals
a <- round(as.numeric(pcg$"1999_low"[13]), 0)
a1 <- round(as.numeric(pcg$"1999_sec"[13]), 0)
a2 <-round(as.numeric(pcg$"1999_third"[13]), 0)
a3 <-round(as.numeric(pcg$"1999_high"[13]), 0)
a4 <-round(as.numeric(state_funding$`Funding Per 1000 Income`[1]), 3)

# creating column of data1
pub_earliest_data <-c(pcn$"96-97"[4], a, a1, a2, a3, a4, public_rev_subs$"Net Tuition Revenue"[2], public_rev_subs$"Subsidy"[2])



b <- round(as.numeric(pcg$"2011_low"[13]), 0)
b1 <- round(as.numeric(pcg$"2011_sec"[13]), 0)
b2 <- round(as.numeric(pcg$"2011_third"[13]), 0)
b3 <- round(as.numeric(pcg$"2011_high"[13]), 0)
b4 <- round(as.numeric(state_funding$`Funding Per 1000 Income`[31]), 3)

pub_latest_data <-c(public_college_netprice$"16-17"[4],  b, b1, b2, b3, b4, public_rev_subs$"Net Tuition Revenue"[4], public_rev_subs$"Subsidy"[4])

pub_percent_change <-c("62.77%", "68.21%", "80.53%", "69.74%", "78.52%", "-28.31%", "47.35%", "-8.5%")

pub_year_frame <-c("1996 to 2016", "1999 to 2011","1999 to 2011", "1999 to 2011","1999 to 2011","1984 to 2014", "2003 to 2013", "2003 to 2013")


# create frame for public data
public_data <- tibble("Type" = expenditure_type, "Data_1" = pub_earliest_data, "Data_2" = pub_latest_data, "Percent_Change" = pub_percent_change, "Time_Frame" = pub_year_frame) 

# create the table
public_data_table <-
head (public_data, 8) |>
  kable(
  booktabs = TRUE
  )

public_data_table
```
## Private Four Year College Data

```{r}
#| message: false
#| echo: false
#| label: tbl-private_data
#| tbl-cap: Private Four Year College Data


prcn <- private_college_netprice
prcg <- private_college_grants

# rounding data and making sure that number is not too long
c <- round(as.numeric(prcg$"1999_low"[4]), 0)
c1 <- round(as.numeric(prcg$"1999_sec"[4]), 0)
c2 <-round(as.numeric(prcg$"1999_third"[4]), 0)
c3 <-round(as.numeric(prcg$"1999_high"[4]), 0)
c4 <-round(as.numeric(state_funding$`Funding Per 1000 Income`[1]), 3)

# creating data 1 column
pri_earliest_data <-c(prcn$"96-97"[4],c, c1, c2, c3, c4, private_rev_subs$"Net Tuition Revenue"[2], private_rev_subs$"Subsidy"[2])


# rounding data and making sure that number is not too long
d <- round(as.numeric(prcg$"2011_low"[4]), 0)
d1 <- round(as.numeric(prcg$"2011_sec"[4]), 0)
d2 <-round(as.numeric(prcg$"2011_third"[4]), 0)
d3 <-round(as.numeric(prcg$"2011_high"[4]), 0)
d4 <-round(as.numeric(state_funding$`Funding Per 1000 Income`[31]), 3)


pri_latest_data <-c(prcn$"16-17"[4], d, d1,d2, d3, d4, private_rev_subs$"Net Tuition Revenue"[4], private_rev_subs$"Subsidy"[4])

pri_percent_change <-c("30.27%", "120%", "80.84%", "28.30%", "97.36%", "-28.31%", "17.62%", "28.86%")

pri_year_frame <-c("1996 to 2016", "1999 to 2011","1999 to 2011", "1999 to 2011","1999 to 2011","1984 to 2014", "2003 to 2013", "2003 to 2013")


# create frame for private data
private_data <- data.frame("Type" = expenditure_type, "Data_1" = pri_earliest_data, "Data_2" = pri_latest_data, "Percent_Change" = pri_percent_change, "Year_Frame" = pri_year_frame) 


# create the table
private_data_table <-
head (private_data, 8) |>
  kable(
  booktabs = TRUE
  )
private_data_table

```

# Discussion

## Findings

The paper by Zhifeng Cai and Jonathan Heathcote delves into the nuanced dynamics between escalating college tuition fees and the widening gap of income inequality in the United States. It posits a model showcasing how increased income disparities significantly drive up tuition costs, thereby impacting college accessibility. The study highlights the strategic role of financial aid and subsidies in counteracting tuition hikes, yet underscores their insufficiency in bridging the educational divide. Through a detailed examination of higher education market dynamics, the paper sheds light on the competitive practices of colleges, such as differential pricing and the allocation of financial aid, aimed at attracting students. This analysis culminates in a discussion on the broader implications for policy, suggesting that reform in financial aid structures and a reevaluation of higher education funding models are imperative to address these challenges. The findings present a critical perspective on the economic forces shaping the higher education landscape, offering insights that could guide policy reforms aimed at ensuring equitable access to college education amidst growing income inequality.

## Dynamics of Canadian Universities using insights by Cai and Heathcote

To explore the dynamics of Canadian universities through the insights provided in the paper by Zhifeng Cai and Jonathan Heathcote and applying a Canadian lens, it's vital to delve into the nuances of tuition trends, income inequality, and access to higher education within Canada. Canadian universities have been experiencing a rise in tuition fees across various programs, with notable increases in professional degrees such as dentistry, medicine, law, and engineering, reflecting a potential barrier to access for students from lower-income backgrounds. The disparities in tuition fees are further exacerbated when considering the level of study, with graduate programs generally demanding higher fees than undergraduate ones, aligning with the expected returns in terms of future employment income.

The socioeconomic landscape in Canada, marked by growing income inequality, has profound implications for higher education access and outcomes. Trends in intergenerational income mobility and income inequality suggest that the economic background of a student's family plays a significant role in their educational opportunities and future earnings, thereby influencing their ability to afford higher education.

Moreover, the stratification of higher education institutions, observed both in the U.S. and Canada, indicates that access to elite institutions is highly influenced by social and economic factors. This stratification is perpetuated by the increasing concentration of resources and student selectivity at more prestigious universities, further challenging the meritocratic ideals of higher education.

Canadian higher education is also characterized by regional disparities in tuition fees and additional compulsory fees, with provinces like Alberta having higher fees compared to the national average. This regional variation adds another layer of complexity to the affordability and accessibility of higher education across the country. The increasing reliance on international students, who pay significantly higher tuition fees, further highlights the financial challenges faced by Canadian universities and the potential impact on domestic students' access to education.

Addressing these challenges requires a multifaceted approach that considers the role of public funding, financial aid, and policies aimed at reducing income inequality and improving access to higher education for all Canadians. Ensuring that higher education remains a pathway for social mobility and economic opportunity is crucial in the face of rising tuition costs and socioeconomic disparities.

## Potential Weaknessess



## Future Research

Future directions should focus on closing gaps in our understanding of the dynamics between income inequality and college tuition. This involves exploring the nuanced effects of policy interventions over the long term and across diverse socio-economic groups. Researchers should consider longitudinal studies that track the impact of tuition changes on generations of students, incorporating variables like technological advancement, labor market shifts, and changing demographics. Policy-wise, a multi-faceted approach is necessary, combining financial aid adjustments, tuition regulation, and innovative funding models for higher education. Engaging with broader societal issues, such as wage stagnation and economic mobility, is crucial for creating more equitable access to higher education. 

Like mentioned in the paper, Cai and Heathcote acknowledges the limitations of using a perfectly competitive model to understand real-world educational markets, where competition among colleges is imperfect and how colleges might use financial aid information to offer less aid to students from wealthier families, particularly at more selective institutions, suggesting these colleges possess significant pricing power. To delve deeper into these complexities, the passage proposes several research extensions such as modeling colleges with unique attributes like location or brand name that could justify differential pricing and attract students with specific preferences. They also raise the idea of exploring how colleges' limited information about applicants' abilities affects students' strategies in applying to multiple institutions. It advocates for broadening the scope of attributes considered in college admissions to include the value of diversity, potentially altering the competitive landscape for colleges seeking to attract students from varied backgrounds. By examining how changes in the value placed on college quality could affect income inequality and intergenerational mobility over time. They hypothesizes that an increase in the financial returns from attending high-quality colleges could lead to greater investment in such education by wealthier families, thereby exacerbating income inequality and reducing social mobility across generations.





\newpage

\appendix

# Appendix {-}


# Additional data details



\newpage


# References


